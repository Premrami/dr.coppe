{"version":3,"file":"cart.js","sources":["../theming/js/cart.js"],"sourcesContent":["class E extends HTMLElement{constructor(){super(),this.addEventListener(\"click\",t=>{t.preventDefault(),(this.closest(\"cart-items\")||this.closest(\"cart-drawer-items\")).updateQuantity(this.dataset.index,0,t)})}}customElements.define(\"cart-remove-button\",E);class S extends HTMLElement{constructor(){super(),this.lineItemStatusElement=document.getElementById(\"shopping-cart-line-item-status\")||document.getElementById(\"CartDrawer-LineItemStatus\");const t=debounce(e=>{this.onChange(e)},ON_CHANGE_DEBOUNCE_TIMER);this.addEventListener(\"change\",t.bind(this))}cartUpdateUnsubscriber=void 0;connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,t=>{if(t.source!==\"cart-items\")return this.onCartUpdate()})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}resetQuantityInput(t){const e=this.querySelector(`#Quantity-${t}`);e.value=e.getAttribute(\"value\"),this.isEnterPressed=!1}setValidity(t,e,a){t.target.setCustomValidity(a),t.target.reportValidity(),this.resetQuantityInput(e),t.target.select()}validateQuantity(t){const e=parseInt(t.target.value),a=t.target.dataset.index;let r=\"\";e<t.target.dataset.min?r=window.quickOrderListStrings.min_error.replace(\"[min]\",t.target.dataset.min):e>parseInt(t.target.max)?r=window.quickOrderListStrings.max_error.replace(\"[max]\",t.target.max):e%parseInt(t.target.step)!==0&&(r=window.quickOrderListStrings.step_error.replace(\"[step]\",t.target.step)),r?this.setValidity(t,a,r):(t.target.setCustomValidity(\"\"),t.target.reportValidity(),this.updateQuantity(a,e,t,document.activeElement.getAttribute(\"name\"),t.target.dataset.quantityVariantId))}onChange(t){this.validateQuantity(t)}onCartUpdate(){return this.tagName===\"CART-DRAWER-ITEMS\"?fetch(`${routes.cart_url}?section_id=cart-drawer`).then(t=>t.text()).then(t=>{const e=new DOMParser().parseFromString(t,\"text/html\"),a=[\"cart-drawer-items\",\".cart-drawer__footer\"];for(const r of a){const s=document.querySelector(r),d=e.querySelector(r);s&&d&&s.replaceWith(d)}}).catch(t=>{console.error(t)}):fetch(`${routes.cart_url}?section_id=main-cart-items`).then(t=>t.text()).then(t=>{const a=new DOMParser().parseFromString(t,\"text/html\").querySelector(\"cart-items\");this.innerHTML=a.innerHTML}).catch(t=>{console.error(t)})}getSectionsToRender(){return[{id:\"main-cart-items\",section:document.getElementById(\"main-cart-items\").dataset.id,selector:\".js-contents\"},{id:\"cart-icon-bubble\",section:\"cart-icon-bubble\",selector:\".shopify-section\"},{id:\"cart-live-region-text\",section:\"cart-live-region-text\",selector:\".shopify-section\"},{id:\"main-cart-footer\",section:document.getElementById(\"main-cart-footer\").dataset.id,selector:\".js-contents\"}]}updateQuantity(t,e,a,r,s){this.enableLoading(t);const d=JSON.stringify({line:t,quantity:e,sections:this.getSectionsToRender().map(c=>c.section),sections_url:window.location.pathname}),y=a.currentTarget instanceof E?\"clear\":\"change\";fetch(`${routes.cart_change_url}`,{...fetchConfig(),body:d}).then(c=>c.text()).then(c=>{const n=JSON.parse(c);CartPerformance.measure(`${y}:paint-updated-sections\"`,()=>{const u=document.getElementById(`Quantity-${t}`)||document.getElementById(`Drawer-quantity-${t}`),I=document.querySelectorAll(\".cart-item\");if(n.errors){u.value=u.getAttribute(\"value\"),this.updateLiveRegions(t,n.errors);return}this.classList.toggle(\"is-empty\",n.item_count===0);const i=document.querySelector(\"cart-drawer\"),p=document.getElementById(\"main-cart-footer\");p&&p.classList.toggle(\"is-empty\",n.item_count===0),i&&i.classList.toggle(\"is-empty\",n.item_count===0),this.getSectionsToRender().forEach(o=>{const f=document.getElementById(o.id).querySelector(o.selector)||document.getElementById(o.id);f.innerHTML=this.getSectionInnerHTML(n.sections[o.section],o.selector)});const l=n.items[t-1]?n.items[t-1].quantity:void 0;let g=\"\";I.length===n.items.length&&l!==parseInt(u.value)&&(typeof l>\"u\"?g=window.cartStrings.error:g=window.cartStrings.quantityError.replace(\"[quantity]\",l)),this.updateLiveRegions(t,g);const m=document.getElementById(`CartItem-${t}`)||document.getElementById(`CartDrawer-Item-${t}`);m&&m.querySelector(`[name=\"${r}\"]`)?i?trapFocus(i,m.querySelector(`[name=\"${r}\"]`)):m.querySelector(`[name=\"${r}\"]`).focus():n.item_count===0&&i?trapFocus(i.querySelector(\".drawer__inner-empty\"),i.querySelector(\"a\")):document.querySelector(\".cart-item\")&&i&&trapFocus(i,document.querySelector(\".cart-item__name\"))}),CartPerformance.measureFromEvent(`${y}:user-action`,a),publish(PUB_SUB_EVENTS.cartUpdate,{source:\"cart-items\",cartData:n,variantId:s})}).catch(()=>{this.querySelectorAll(\".loading__spinner\").forEach(n=>n.classList.add(\"hidden\"));const c=document.getElementById(\"cart-errors\")||document.getElementById(\"CartDrawer-CartErrors\");c.textContent=window.cartStrings.error}).finally(()=>{this.disableLoading(t)})}updateLiveRegions(t,e){const a=document.getElementById(`Line-item-error-${t}`)||document.getElementById(`CartDrawer-LineItemError-${t}`);a&&(a.querySelector(\".cart-item__error-text\").textContent=e),this.lineItemStatusElement.setAttribute(\"aria-hidden\",!0);const r=document.getElementById(\"cart-live-region-text\")||document.getElementById(\"CartDrawer-LiveRegionText\");r.setAttribute(\"aria-hidden\",!1),setTimeout(()=>{r.setAttribute(\"aria-hidden\",!0)},1e3)}getSectionInnerHTML(t,e){return new DOMParser().parseFromString(t,\"text/html\").querySelector(e).innerHTML}enableLoading(t){(document.getElementById(\"main-cart-items\")||document.getElementById(\"CartDrawer-CartItems\")).classList.add(\"cart__items--disabled\");const a=this.querySelectorAll(`#CartItem-${t} .loading__spinner`),r=this.querySelectorAll(`#CartDrawer-Item-${t} .loading__spinner`);[...a,...r].forEach(s=>s.classList.remove(\"hidden\")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute(\"aria-hidden\",!1)}disableLoading(t){(document.getElementById(\"main-cart-items\")||document.getElementById(\"CartDrawer-CartItems\")).classList.remove(\"cart__items--disabled\");const a=this.querySelectorAll(`#CartItem-${t} .loading__spinner`),r=this.querySelectorAll(`#CartDrawer-Item-${t} .loading__spinner`);a.forEach(s=>s.classList.add(\"hidden\")),r.forEach(s=>s.classList.add(\"hidden\"))}}customElements.define(\"cart-items\",S);customElements.get(\"cart-note\")||customElements.define(\"cart-note\",class extends HTMLElement{constructor(){super(),this.addEventListener(\"input\",debounce(t=>{const e=JSON.stringify({note:t.target.value});fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:e}).then(()=>CartPerformance.measureFromEvent(\"note-update:user-action\",t))},ON_CHANGE_DEBOUNCE_TIMER))}});\r\n"],"names":["t","S","e","a","s","d","c","n","u","o","f","l","g","m","r"],"mappings":"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"}