{"version":3,"file":"product-form.js","sources":["../theming/js/product-form.js"],"sourcesContent":["customElements.get(\"product-form\")||customElements.define(\"product-form\",class extends HTMLElement{constructor(){super(),this.form=this.querySelector(\"form\"),this.variantIdInput.disabled=!1,this.form.addEventListener(\"submit\",this.onSubmitHandler.bind(this)),this.cart=document.querySelector(\"cart-notification\")||document.querySelector(\"cart-drawer\"),this.submitButton=this.querySelector('[type=\"submit\"]'),this.submitButtonText=this.submitButton.querySelector(\"span\"),document.querySelector(\"cart-drawer\")&&this.submitButton.setAttribute(\"aria-haspopup\",\"dialog\"),this.hideErrors=this.dataset.hideErrors===\"true\"}onSubmitHandler(e){if(e.preventDefault(),this.submitButton.getAttribute(\"aria-disabled\")===\"true\")return;this.handleErrorMessage(),this.submitButton.setAttribute(\"aria-disabled\",!0),this.submitButton.classList.add(\"loading\"),this.querySelector(\".loading__spinner\").classList.remove(\"hidden\");const r=fetchConfig(\"javascript\");r.headers[\"X-Requested-With\"]=\"XMLHttpRequest\",delete r.headers[\"Content-Type\"];const s=new FormData(this.form);this.cart&&(s.append(\"sections\",this.cart.getSectionsToRender().map(t=>t.id)),s.append(\"sections_url\",window.location.pathname),this.cart.setActiveElement(document.activeElement)),r.body=s,fetch(`${routes.cart_add_url}`,r).then(t=>t.json()).then(t=>{if(t.status){publish(PUB_SUB_EVENTS.cartError,{source:\"product-form\",productVariantId:s.get(\"id\"),errors:t.errors||t.description,message:t.message}),this.handleErrorMessage(t.description);const a=this.submitButton.querySelector(\".sold-out-message\");if(!a)return;this.submitButton.setAttribute(\"aria-disabled\",!0),this.submitButtonText.classList.add(\"hidden\"),a.classList.remove(\"hidden\"),this.error=!0;return}else if(!this.cart){window.location=window.routes.cart_url;return}const o=CartPerformance.createStartingMarker(\"add:wait-for-subscribers\");this.error||publish(PUB_SUB_EVENTS.cartUpdate,{source:\"product-form\",productVariantId:s.get(\"id\"),cartData:t}).then(()=>{CartPerformance.measureFromMarker(\"add:wait-for-subscribers\",o)}),this.error=!1;const i=this.closest(\"quick-add-modal\");i?(document.body.addEventListener(\"modalClosed\",()=>{setTimeout(()=>{CartPerformance.measure(\"add:paint-updated-sections\",()=>{this.cart.renderContents(t)})})},{once:!0}),i.hide(!0)):CartPerformance.measure(\"add:paint-updated-sections\",()=>{this.cart.renderContents(t)})}).catch(t=>{console.error(t)}).finally(()=>{this.submitButton.classList.remove(\"loading\"),this.cart&&this.cart.classList.contains(\"is-empty\")&&this.cart.classList.remove(\"is-empty\"),this.error||this.submitButton.removeAttribute(\"aria-disabled\"),this.querySelector(\".loading__spinner\").classList.add(\"hidden\"),CartPerformance.measureFromEvent(\"add:user-action\",e)})}handleErrorMessage(e=!1){this.hideErrors||(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(\".product-form__error-message-wrapper\"),this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(\".product-form__error-message\"),this.errorMessageWrapper.toggleAttribute(\"hidden\",!e),e&&(this.errorMessage.textContent=e)))}toggleSubmitButton(e=!0,r){e?(this.submitButton.setAttribute(\"disabled\",\"disabled\"),r&&(this.submitButtonText.textContent=r)):(this.submitButton.removeAttribute(\"disabled\"),this.submitButtonText.textContent=window.variantStrings.addToCart)}get variantIdInput(){return this.form.querySelector(\"[name=id]\")}});\n"],"names":[],"mappings":"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"}