{"version":3,"file":"localization-form.js","sources":["../theming/js/localization-form.js"],"sourcesContent":["customElements.get(\"localization-form\")||customElements.define(\"localization-form\",class extends HTMLElement{constructor(){super(),this.mql=window.matchMedia(\"(min-width: 750px)\"),this.header=document.querySelector(\".header-wrapper\"),this.elements={input:this.querySelector('input[name=\"locale_code\"], input[name=\"country_code\"]'),button:this.querySelector(\"button.localization-form__select\"),panel:this.querySelector(\".disclosure__list-wrapper\"),search:this.querySelector('input[name=\"country_filter\"]'),closeButton:this.querySelector(\".country-selector__close-button\"),resetButton:this.querySelector(\".country-filter__reset-button\"),searchIcon:this.querySelector(\".country-filter__search-icon\"),liveRegion:this.querySelector(\"#sr-country-search-results\")},this.addEventListener(\"keyup\",this.onContainerKeyUp.bind(this)),this.addEventListener(\"keydown\",this.onContainerKeyDown.bind(this)),this.addEventListener(\"focusout\",this.closeSelector.bind(this)),this.elements.button.addEventListener(\"click\",this.openSelector.bind(this)),this.elements.search&&(this.elements.search.addEventListener(\"keyup\",this.filterCountries.bind(this)),this.elements.search.addEventListener(\"focus\",this.onSearchFocus.bind(this)),this.elements.search.addEventListener(\"blur\",this.onSearchBlur.bind(this)),this.elements.search.addEventListener(\"keydown\",this.onSearchKeyDown.bind(this))),this.elements.closeButton&&this.elements.closeButton.addEventListener(\"click\",this.hidePanel.bind(this)),this.elements.resetButton&&(this.elements.resetButton.addEventListener(\"click\",this.resetFilter.bind(this)),this.elements.resetButton.addEventListener(\"mousedown\",e=>e.preventDefault())),this.querySelectorAll(\"a\").forEach(e=>e.addEventListener(\"click\",this.onItemClick.bind(this)))}hidePanel(){this.elements.button.setAttribute(\"aria-expanded\",\"false\"),this.elements.panel.setAttribute(\"hidden\",!0),this.elements.search&&(this.elements.search.value=\"\",this.filterCountries(),this.elements.search.setAttribute(\"aria-activedescendant\",\"\")),document.body.classList.remove(\"overflow-hidden-mobile\"),document.querySelector(\".menu-drawer\").classList.remove(\"country-selector-open\"),this.header.preventHide=!1}onContainerKeyDown(e){const t=Array.from(this.querySelectorAll(\"a\")).filter(i=>!i.parentElement.classList.contains(\"hidden\"));let s=t.findIndex(i=>i===document.activeElement),n;switch(e.code.toUpperCase()){case\"ARROWUP\":e.preventDefault(),n=s>0?t[s-1]:t[t.length-1],n.focus();break;case\"ARROWDOWN\":e.preventDefault(),n=s<t.length-1?t[s+1]:t[0],n.focus();break}this.elements.search&&setTimeout(()=>{s=t.findIndex(i=>i===document.activeElement),s>-1?this.elements.search.setAttribute(\"aria-activedescendant\",t[s].id):this.elements.search.setAttribute(\"aria-activedescendant\",\"\")})}onContainerKeyUp(e){switch(e.preventDefault(),e.code.toUpperCase()){case\"ESCAPE\":if(this.elements.button.getAttribute(\"aria-expanded\")==\"false\")return;this.hidePanel(),e.stopPropagation(),this.elements.button.focus();break;case\"SPACE\":if(this.elements.button.getAttribute(\"aria-expanded\")==\"true\")return;this.openSelector();break}}onItemClick(e){e.preventDefault();const t=this.querySelector(\"form\");this.elements.input.value=e.currentTarget.dataset.value,t&&t.submit()}openSelector(){this.elements.button.focus(),this.elements.panel.toggleAttribute(\"hidden\"),this.elements.button.setAttribute(\"aria-expanded\",(this.elements.button.getAttribute(\"aria-expanded\")===\"false\").toString()),document.body.classList.contains(\"overflow-hidden-tablet\")||document.body.classList.add(\"overflow-hidden-mobile\"),this.elements.search&&this.mql.matches&&this.elements.search.focus(),this.hasAttribute(\"data-prevent-hide\")&&(this.header.preventHide=!0),document.querySelector(\".menu-drawer\").classList.add(\"country-selector-open\")}closeSelector(e){(e.target.classList.contains(\"country-selector__overlay\")||!this.contains(e.target)||!this.contains(e.relatedTarget))&&this.hidePanel()}normalizeString(e){return e.normalize(\"NFD\").replace(new RegExp(\"\\\\p{Diacritic}\",\"gu\"),\"\").toLowerCase()}filterCountries(){const e=this.normalizeString(this.elements.search.value),t=this.querySelector(\".popular-countries\"),s=this.querySelectorAll(\"a\");let n=s.length;this.elements.resetButton.classList.toggle(\"hidden\",!e),t&&t.classList.toggle(\"hidden\",e),s.forEach(i=>{this.normalizeString(i.querySelector(\".country\").textContent).indexOf(e)>-1?(i.parentElement.classList.remove(\"hidden\"),n++):(i.parentElement.classList.add(\"hidden\"),n--)}),this.elements.liveRegion&&(this.elements.liveRegion.innerHTML=window.accessibilityStrings.countrySelectorSearchCount.replace(\"[count]\",n)),this.querySelector(\".country-selector\").scrollTop=0,this.querySelector(\".country-selector__list\").scrollTop=0}resetFilter(e){e.stopPropagation(),this.elements.search.value=\"\",this.filterCountries(),this.elements.search.focus()}onSearchFocus(){this.elements.searchIcon.classList.add(\"country-filter__search-icon--hidden\")}onSearchBlur(){this.elements.search.value||this.elements.searchIcon.classList.remove(\"country-filter__search-icon--hidden\")}onSearchKeyDown(e){e.code.toUpperCase()===\"ENTER\"&&e.preventDefault()}});\r\n"],"names":["i","n"],"mappings":"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"}