{"version":3,"file":"recipient-form.js","sources":["../theming/js/recipient-form.js"],"sourcesContent":["customElements.get(\"recipient-form\")||customElements.define(\"recipient-form\",class extends HTMLElement{constructor(){super(),this.recipientFieldsLiveRegion=this.querySelector(`#Recipient-fields-live-region-${this.dataset.sectionId}`),this.checkboxInput=this.querySelector(`#Recipient-checkbox-${this.dataset.sectionId}`),this.checkboxInput.disabled=!1,this.hiddenControlField=this.querySelector(`#Recipient-control-${this.dataset.sectionId}`),this.hiddenControlField.disabled=!0,this.emailInput=this.querySelector(`#Recipient-email-${this.dataset.sectionId}`),this.nameInput=this.querySelector(`#Recipient-name-${this.dataset.sectionId}`),this.messageInput=this.querySelector(`#Recipient-message-${this.dataset.sectionId}`),this.sendonInput=this.querySelector(`#Recipient-send-on-${this.dataset.sectionId}`),this.offsetProperty=this.querySelector(`#Recipient-timezone-offset-${this.dataset.sectionId}`),this.offsetProperty&&(this.offsetProperty.value=new Date().getTimezoneOffset().toString()),this.errorMessageWrapper=this.querySelector(\".product-form__recipient-error-message-wrapper\"),this.errorMessageList=this.errorMessageWrapper?.querySelector(\"ul\"),this.errorMessage=this.errorMessageWrapper?.querySelector(\".error-message\"),this.defaultErrorHeader=this.errorMessage?.innerText,this.currentProductVariantId=this.dataset.productVariantId,this.addEventListener(\"change\",this.onChange.bind(this)),this.onChange()}cartUpdateUnsubscriber=void 0;variantChangeUnsubscriber=void 0;cartErrorUnsubscriber=void 0;connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,e=>{e.source===\"product-form\"&&e.productVariantId.toString()===this.currentProductVariantId&&this.resetRecipientForm()}),this.variantChangeUnsubscriber=subscribe(PUB_SUB_EVENTS.variantChange,e=>{e.data.sectionId===this.dataset.sectionId&&(this.currentProductVariantId=e.data.variant.id.toString())}),this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartError,e=>{e.source===\"product-form\"&&e.productVariantId.toString()===this.currentProductVariantId&&this.displayErrorMessage(e.message,e.errors)})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber(),this.variantChangeUnsubscriber&&this.variantChangeUnsubscriber(),this.cartErrorUnsubscriber&&this.cartErrorUnsubscriber()}onChange(){this.checkboxInput.checked?(this.enableInputFields(),this.recipientFieldsLiveRegion.innerText=window.accessibilityStrings.recipientFormExpanded):(this.clearInputFields(),this.disableInputFields(),this.clearErrorMessage(),this.recipientFieldsLiveRegion.innerText=window.accessibilityStrings.recipientFormCollapsed)}inputFields(){return[this.emailInput,this.nameInput,this.messageInput,this.sendonInput]}disableableFields(){return[...this.inputFields(),this.offsetProperty]}clearInputFields(){this.inputFields().forEach(e=>e.value=\"\")}enableInputFields(){this.disableableFields().forEach(e=>e.disabled=!1)}disableInputFields(){this.disableableFields().forEach(e=>e.disabled=!0)}displayErrorMessage(e,t){if(this.clearErrorMessage(),this.errorMessageWrapper.hidden=!1,typeof t==\"object\")return this.errorMessage.innerText=this.defaultErrorHeader,Object.entries(t).forEach(([r,s])=>{const a=`RecipientForm-${r}-error-${this.dataset.sectionId}`,d=`#Recipient-${r}-${this.dataset.sectionId}`,n=`${s.join(\", \")}`,c=this.querySelector(`#${a}`),o=c?.querySelector(\".error-message\");if(!o)return;this.errorMessageList&&this.errorMessageList.appendChild(this.createErrorListItem(d,n)),o.innerText=`${n}.`,c.classList.remove(\"hidden\");const i=this[`${r}Input`];i&&(i.setAttribute(\"aria-invalid\",!0),i.setAttribute(\"aria-describedby\",a))});this.errorMessage.innerText=t}createErrorListItem(e,t){const r=document.createElement(\"li\"),s=document.createElement(\"a\");return s.setAttribute(\"href\",e),s.innerText=t,r.appendChild(s),r.className=\"error-message\",r}clearErrorMessage(){this.errorMessageWrapper.hidden=!0,this.errorMessageList&&(this.errorMessageList.innerHTML=\"\"),this.querySelectorAll(\".recipient-fields .form__message\").forEach(e=>{e.classList.add(\"hidden\");const t=e.querySelector(\".error-message\");t&&(t.innerText=\"\")}),[this.emailInput,this.messageInput,this.nameInput,this.sendonInput].forEach(e=>{e.setAttribute(\"aria-invalid\",!1),e.removeAttribute(\"aria-describedby\")})}resetRecipientForm(){this.checkboxInput.checked&&(this.checkboxInput.checked=!1,this.clearInputFields(),this.clearErrorMessage())}});\r\n"],"names":[],"mappings":"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"}